<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="container"></div>
    <div id="container2"></div>
    <script type="module">
        import { h, Fragment, Portal } from './src/h.js'
        import { Component } from './src/component.js'
        import { render } from './src/render.js'

        const container = document.querySelector('#container')

        // const v = h('div', null, h('span'))
        // console.log(v)

        // const text = h('div', null, '我是文本')
        // console.log(text)

        // const fragment = h(Fragment, null, [h('h1'), h('h1')])
        // console.log(fragment)

        // const portal = h(Portal, { target: '#box' }, h('h1'))
        // console.log(portal)

        // const MyFunctionalComponent = () => {}
        // const functional = h(MyFunctionalComponent, null, h('div'))
        // console.log(functional)

        // class MyStatefulComponent extends Component {}
        // const statefulComponent = h(MyStatefulComponent, null, h('div'))
        // console.log(statefulComponent)

        // class NoneStateful {}
        // const noneStateful = h(NoneStateful, null, h('div'))
        // console.log(noneStateful)

        // const dynamicClass = ['class-c', 'class-d']
        // const div = h('div', {
        //     style: {
        //         width: '100px',
        //         height: '100px',
        //         backgroundColor: '#f00'
        //     },
        //     class: ['class-a', 'class-b', dynamicClass]
        // }, [
        //     h('div', { style: { width: '10px', height: '10px', backgroundColor: 'green'} }),
        //     h('div', { style: { width: '20px', height: '20px', backgroundColor: 'yellow'} })
        // ])
        // render(div, document.querySelector('#container'))

        // // 验证 Attr
        // const input = h('input', {
        //     type: 'checkbox',
        //     checked: true,
        //     custom: '1'
        // }, null)
        // console.log(input)
        // render(input, document.querySelector('#container'))


        // // 验证event
        // const div = h('div', {
        //     style: {
        //         width: '100px',
        //         height: '100px',
        //         backgroundColor: 'red'
        //     },
        //     onclick: () => {
        //         alert(123)
        //     }
        // })
        // render(div, document.querySelector('#container'))

        // Text
        // const text = h('div', null, '我是文本')
        // console.log(text)
        // render(text, document.querySelector('#container'))

        // Fragemnt
        // const fragment = h(Fragment, null, [
        //     h('span', null, '文本1'),
        //     h('span', null, '文本2')
        // ])
        // render(fragment, document.querySelector('#container'))

        // Portal
        // const portal = h(Portal, {
        //     target: 'body'
        // }, [
        //     h('span', null, '文本3'),
        //     h('span', null, '文本4')
        // ])
        // render(portal, document.querySelector('#container'))

        // Component
        // class MyComponent {
        //     render () {
        //         return h('div', {
        //             style: {
        //                 width: '100px',
        //                 height: '100px',
        //                 backgroundColor: 'green'
        //             }
        //         }, [
        //             h('span', null, '我是组件文字1'),
        //             h('span', null, '我是组件文字2')
        //         ])
        //     }
        // }
        // const comp = h(MyComponent)
        // console.log(comp)
        // render(comp, document.querySelector('#container'))


        // functional Component
        // const MyFunctionComponent = () => {
        //     return h('div', null, [
        //         h('span', null, '函数式组件')
        //     ])
        // }
        // const f = h(MyFunctionComponent)
        // console.log(f)
        // render(f, document.querySelector('#container'))

        // patch replaceNode
        // const prevVNode = h('div', null, h('span', null, '我是前一个组件'))
        // class MyComponent {
        //     render () {
        //         return h('div', null, [
        //             h('span', null, '我是后一个组件')
        //         ])
        //     }
        // }
        // const nextVNode = h(MyComponent)

        // render(prevVNode, document.querySelector('#container'))
        // render(nextVNode, document.querySelector('#container'))

        // patch style
        // const prevVNode = h('div', {
        //     style: {
        //         width: '100px',
        //         height: '100px',
        //         backgroundColor: 'black'
        //     },
        //     custom1: '123'
        // }, null)

        // const nextVNode = h('div', {
        //     style: {
        //         width: '200px',
        //         height: '200px',
        //         border: '2px solid #f00'
        //     },
        //     custom2: '456'
        // })

        // render(prevVNode, document.querySelector('#container'))
        // render(nextVNode, document.querySelector('#container'))

        // patch children
        // const prevVNode = h('div', null, h(Fragment, null, [
        //     h('p', {
        //         style: {
        //             width: '100px',
        //             height: '100px',
        //             background: 'red'
        //         }
        //     }),
        //     h('p', {
        //         style: {
        //             width: '100px',
        //             height: '100px',
        //             background: 'red'
        //         }
        //     })
        // ]))

        // const nextVNode = h('div')

        // console.log(prevVNode, nextVNode)

        // render(prevVNode, document.querySelector('#container'))
        // setTimeout(() => {
        //     render(nextVNode, document.querySelector('#container'))
        // }, 2000)

        // patch children
        // const prevVNode = h('div', null, [
        //     h('p', {
        //         style: {
        //             width: '100px',
        //             height: '100px',
        //             backgroundColor: 'yellow'
        //         }
        //     }),
        //     h('p', {
        //         style: {
        //             width: '100px',
        //             height: '100px',
        //             backgroundColor: 'black'
        //         }
        //     }),
        // ])

        // const nextVNode = h('div', null, [
        //     h('p', {
        //             style: {
        //                 width: '100px',
        //                 height: '100px',
        //                 backgroundColor: 'red'
        //             }
        //     }),

        //     h('p', {
        //         style: {
        //             width: '100px',
        //             height: '100px',
        //             backgroundColor: 'green'
        //         }
        // })
        // ])

        // render(prevVNode, container)
        // setTimeout(() => {
        //     render(nextVNode, container)
        // }, 2000)


        // patch fragment
        // const prev = h(Fragment, null, [
        //     h('div', null , '片段1'),
        //     h('div', null , '片段2'),
        //     h('div', null , '片段3')
        // ])

        // const next = h(Fragment, null, [
        //     h('div', null , '片段4'),
        //     h('div', null , '片段5'),
        //     h('div', null , '片段6')
        // ])
        // render(prev, container)

        // setTimeout(() => {
        //     render(next, container)
        // }, 2000)


        // // patch text
        // const prev = h('div', null, '旧文本')
        // const next = h('div', null, '旧文本')

        // render(prev, container)

        // setTimeout(() => {
        //     render(next, container)
        // }, 2000)

        // patch portal
        // const prev = h(Portal, {
        //     target: '#container'
        // }, [
        //     h('span', null, 123)
        // ])

        // const next = h(Portal, {
        //     target: '#container'
        // }, [
        //     h(Portal, {
        //         target: '#container'
        //     }, h('span', null, 456)),
        //     h('span', null, 789)
        // ])

        // render(prev, document.body)
        // setTimeout(() => {
        //     render(next, document.body)
        // }, 2000)


        // patch Component
        // class MyComponent {
        //     state = 'one'

        //     mounted () {
        //         setTimeout(() => {
        //             this.state = 'two'
        //             this._update()
        //         }, 2000)
        //     }

        //     render () {
        //         return h('div', null, this.state)
        //     }
        // }

        // const vn = h(MyComponent)
        // render(vn, container)

        // class ChildComponent {
        //     render () {
        //         return h('div', null, this.$props.text)
        //     }
        // }

        // class Parent {
        //     state = 'one'

        //     mounted () {
        //         setTimeout(() => {
        //             this.state = 'two'
        //             this._update()
        //         }, 2000)
        //     }

        //     render () {
        //         return h(ChildComponent, {
        //             // 父组件向子组件传递props
        //             text: this.state
        //         })
        //     }
        // }

        // const vnode = h(Parent)

        // render(vnode, container)

        // 不同子组件的组件类型更新
        // class ChildComponent1 {
        //     unmounted () {
        //         console.log('触发了 unmounted')
        //     }

        //     render () {
        //         return h('div', null, 123)
        //     }
        // }

        // class ChildComponent2 {
        //     render () {
        //         return h('div', null, 456)
        //     }
        // }

        // class Parent {
        //     isTrue = true

        //     mounted () {
        //         setTimeout(() => {
        //             this.isTrue = false
        //             this._update()
        //         }, 2000)
        //     }

        //     render () {
        //         return this.isTrue ? h(ChildComponent1) : h(ChildComponent2)
        //     }
        // }

        // render(h(Parent), container)

        // 函数式组件
        const MyFunctionalComponent = props => {
            return h('div', null, props.text)
        }

        class Parent {
            text = 13

            mounted () {
                setTimeout(() => {
                    this.text = 14
                    this._update()
                }, 2000)
            }

            render () {
                return h(MyFunctionalComponent, {
                    text:  this.text
                })
            }
        }

        render(h(Parent), container)
    </script>
</body>
</html>